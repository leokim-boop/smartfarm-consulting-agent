# 프로젝트 개요

## 1. 프로젝트 개요

### 서비스 한 줄 설명
**팜비트**: 실내 스마트팜 자동견적 및 AI 기반 사업성 분석 리포트를 제공하는 플랫폼

### 주요 타겟
- **교육기관**: 학교, 대학의 실습용 스마트팜 구축
- **의료기관**: 병원 내 식물 재배 시설 구축
- **창업자**: 스마트팜 창업을 고려하는 개인/법인
- **기업**: 사내 식물 재배 시설 도입 검토 기업

### 해결하려는 문제
1. **견적 요청의 복잡성**: 전통적인 견적 요청 시 여러 업체에 개별 문의 필요, 응답 지연
2. **사업성 검토의 어려움**: 초기 투자 대비 수익성, ROI, 투자 회수기간 등 정량적 분석 부재
3. **기술 정보 접근성**: 스마트가든, 무빙랙, 고정식 등 다양한 시스템의 특성과 적합성 파악 어려움
4. **비전문가의 진입 장벽**: 스마트팜 도입을 고려하지만 기술적 지식이 부족한 사용자 지원

---

## 2. 핵심 기능 목록

### 2.1 설문/챗봇형 견적 입력
- **다단계 폼 (STEP 1~4)**: 사용자 친화적인 단계별 정보 수집
- **정형화된 입력**: 자유 텍스트 최소화, 선택지 기반 입력으로 데이터 품질 향상
- **실시간 검증**: React Hook Form + Zod를 통한 클라이언트 사이드 유효성 검사
- **진행 상태 표시**: 현재 단계 및 전체 진행률 시각화

### 2.2 스마트가든/무빙랙 기반 자동 견적 산출
- **시스템 타입별 견적 로직**:
  - 스마트가든: 단가 × 수량 + 설치비 + 운영비
  - 무빙랙: 랙 단가 × 수량 + 모터/제어 시스템 비용 + 설치비
- **규모별 할인율 적용**: 수량에 따른 단가 조정
- **설치 환경 고려**: 공간 크기, 전력 사양 등에 따른 추가 비용 반영

### 2.3 고정식 5단 이상 비추천 로직
- **비즈니스 규칙**: 고정식 5단 이상은 설치/관리 복잡도 증가로 인해 비추천
- **대안 제시**: 스마트가든 또는 무빙랙으로의 전환 권장
- **예외 처리**: 사용자가 명시적으로 고정식 5단 이상을 선택한 경우 경고 메시지 표시

### 2.4 AI 사업성 리포트
- **ROI 계산**: 초기 투자 대비 예상 수익률 산출
- **투자 회수기간**: Break-even point 계산
- **운영비 분석**: 전력비, 인건비, 유지보수비 등 월간/연간 운영비용 산정
- **수익성 시나리오**: 보수적/일반/낙관적 시나리오별 수익성 분석
- **LLM 기반 리포트 생성**: OpenAI API 또는 유사 API를 활용한 자연어 리포트 생성

### 2.5 견적 결과 저장 및 상담 요청
- **견적 데이터 저장**: Supabase Postgres에 견적 정보 저장
- **상담 요청 기능**: 견적 확인 후 전문 상담사 연결 요청
- **이메일 알림**: 상담 요청 시 관리자/상담사에게 알림 발송 (향후 구현)

---

## 3. 주요 사용자 플로우

### 3.1 전체 플로우 다이어그램

```
[방문] 
  ↓
[인트로 화면] - 서비스 소개 및 시작 버튼
  ↓
[STEP 1: 기본 정보] - 공간 크기, 용도, 예산 범위
  ↓
[STEP 2: 시스템 선택] - 스마트가든 / 무빙랙 / 고정식 선택
  ↓
[STEP 3: 상세 설정] - 수량, 옵션, 설치 환경
  ↓
[STEP 4: 운영 정보] - 운영 기간, 목표 생산량 등
  ↓
[요약 확인] - 입력 정보 검토 및 수정
  ↓
[견적 결과] - 자동 계산된 견적 금액 표시
  ↓
[AI 리포트] - 사업성 분석 리포트 생성 및 표시
  ↓
[상담 요청] - 전문 상담사 연결 요청 (선택)
```

### 3.2 단계별 상세 플로우

#### STEP 1: 기본 정보
1. 공간 크기 입력 (㎡ 또는 평)
2. 용도 선택 (교육/의료/창업/기업)
3. 예산 범위 선택 (드롭다운: ~500만원 / 500~1000만원 / 1000~3000만원 / 3000만원 이상)

#### STEP 2: 시스템 선택
1. 시스템 타입 선택 (라디오 버튼)
   - 스마트가든 (권장)
   - 무빙랙 (권장)
   - 고정식 (5단 이상 선택 시 경고)
2. 선택 이유 간단 선택 (선택사항)

#### STEP 3: 상세 설정
1. 수량 입력
2. 추가 옵션 선택 (LED 조명, 자동 급수, 환경 제어 시스템 등)
3. 설치 환경 정보 (전력 사양, 천장 높이 등)

#### STEP 4: 운영 정보
1. 운영 기간 선택 (1년 / 3년 / 5년 / 장기)
2. 목표 생산량 (월간 또는 연간)
3. 판매 채널 (자체 소비 / 직판 / 유통 등)

#### 요약 확인
- 모든 입력 정보를 카드 형태로 표시
- 각 섹션별 수정 버튼 제공
- 최종 제출 전 최종 확인

#### 견적 결과
- 총 견적 금액 (큰 글씨 강조)
- 항목별 상세 내역 (표 형태)
- 시스템 구성도 (시각화, 향후 구현)

#### AI 리포트
- 리포트 생성 중 로딩 상태 표시
- 생성된 리포트 섹션:
  - 투자 개요
  - ROI 분석
  - 투자 회수기간
  - 운영비 분석
  - 수익성 시나리오
  - 결론 및 권장사항

#### 상담 요청
- 이름, 연락처, 이메일 입력
- 상담 희망 일시 선택 (선택사항)
- 요청 사유 간단 입력 (선택사항)
- 제출 후 완료 메시지 표시

---

## 4. 기술 스택 개요

### 4.1 Frontend

| 기술 | 버전/설명 | 용도 |
|------|-----------|------|
| **Next.js** | 14.x (App Router) | React 프레임워크, SSR/SSG 지원 |
| **TypeScript** | 5.x | 타입 안정성 보장 |
| **Tailwind CSS** | 3.x | 유틸리티 기반 스타일링 |
| **React Hook Form** | 7.x | 폼 상태 관리 및 검증 |
| **Zod** | 3.x | 스키마 기반 유효성 검사 |
| **shadcn/ui** | 최신 | 재사용 가능한 UI 컴포넌트 (선택) |

### 4.2 Backend

| 기술 | 설명 | 용도 |
|------|------|------|
| **Supabase** | BaaS 플랫폼 | 데이터베이스 및 인증 |
| **PostgreSQL** | Supabase 제공 | 관계형 데이터베이스 |
| **Supabase Auth** | 내장 인증 | 사용자 인증 (향후 확장) |
| **Supabase Edge Functions** | 선택사항 | 서버리스 함수 (AI 리포트 생성 등) |

### 4.3 Infrastructure

| 서비스 | 용도 | 설명 |
|--------|------|------|
| **Vercel** | 프론트엔드 호스팅 | Next.js 최적화 배포 |
| **Vercel Serverless Functions** | API 라우트 | Next.js API Routes 실행 |
| **Supabase** | 데이터베이스 호스팅 | Postgres 인스턴스 관리 |

### 4.4 AI/LLM 연동 (향후)

| 서비스 | 용도 | 설명 |
|--------|------|------|
| **OpenAI API** | 리포트 생성 | GPT 모델을 활용한 자연어 리포트 생성 |
| **대안** | - | Anthropic Claude, Google Gemini 등 |

### 4.5 개발 도구

| 도구 | 용도 |
|------|------|
| **ESLint** | 코드 품질 검사 |
| **Prettier** | 코드 포맷팅 |
| **Husky** | Git hooks 관리 (선택) |
| **TypeScript** | 타입 체크 |

---

## 5. 주요 설계 원칙

### 5.1 정형 폼 입력 (자유 텍스트 최소화)
- **이유**: 데이터 품질 향상, 분석 용이성, AI 리포트 생성의 정확도 향상
- **구현**: 드롭다운, 라디오 버튼, 체크박스, 숫자 입력 위주
- **예외**: 상담 요청 시 요청 사유는 자유 텍스트 허용 (선택사항)

### 5.2 챗봇형 UX + 안정적인 검증/DB 저장 구조
- **UX**: 단계별 진행, 진행률 표시, 이전 단계로 돌아가기 가능
- **검증**: 클라이언트 사이드 (Zod) + 서버 사이드 (Supabase RLS 또는 API 검증)
- **DB 저장**: 각 단계 완료 시 임시 저장, 최종 제출 시 영구 저장

### 5.3 4단 스마트가든/무빙랙을 기본 추천, 고정식은 예외 취급
- **비즈니스 로직**: 
  - 기본 추천: 스마트가든, 무빙랙
  - 고정식 5단 이상 선택 시 경고 메시지 및 대안 제시
- **구현 위치**: STEP 2 시스템 선택 단계에서 조건부 렌더링

### 5.4 추후 기능 확장을 고려한 모듈화
- **폼 스키마 분리**: `lib/schemas/` 디렉토리에 Zod 스키마 정의
- **비즈니스 로직 분리**: `lib/utils/` 또는 `lib/business/` 디렉토리에 견적 계산 로직 분리
- **UI 컴포넌트 분리**: `components/` 디렉토리에 재사용 가능한 컴포넌트 분리
- **API 라우트 분리**: `app/api/` 디렉토리에 엔드포인트별 분리

### 5.5 데이터베이스 설계 원칙
- **정규화**: 중복 데이터 최소화
- **인덱싱**: 자주 조회되는 컬럼에 인덱스 추가
- **RLS (Row Level Security)**: 향후 사용자별 데이터 접근 제어 준비
- **마이그레이션**: Supabase 마이그레이션 도구 활용

---

## 6. 향후 확장 아이디어

### 6.1 사용자 계정/로그인 + 견적 히스토리
- **기능**: Supabase Auth를 활용한 이메일/소셜 로그인
- **데이터**: 사용자별 견적 히스토리 저장 및 조회
- **UI**: 마이페이지에서 이전 견적 목록 및 상세 조회

### 6.2 견적 PDF 자동 생성
- **기능**: 견적 결과를 PDF로 다운로드
- **기술**: `react-pdf` 또는 서버 사이드 PDF 생성 라이브러리
- **포함 내용**: 견적 상세 내역, AI 리포트 요약, 연락처 정보

### 6.3 관리자용 대시보드
- **기능**: 입력 데이터 통계 및 분석
- **지표**:
  - 일일/월간 견적 요청 수
  - 시스템 타입별 선택 비율
  - 예산 범위별 분포
  - 지역별 분포 (향후)
- **기술**: Next.js Admin 페이지 또는 별도 대시보드 앱

### 6.4 농산물 가격 API 연동 후 실시간 수익성 분석
- **기능**: 실제 농산물 시세를 반영한 수익성 분석
- **데이터 소스**: 
  - 한국농수산식품유통공사 (aT) API
  - 농림축산식품부 공공데이터
- **분석**: 작물별 예상 수익, 시장 가격 변동성 고려

### 6.5 추가 확장 아이디어
- **비교 기능**: 여러 견적을 동시에 비교하는 기능
- **공유 기능**: 견적 결과를 링크로 공유
- **알림 기능**: 견적 상태 변경 시 이메일/SMS 알림
- **채팅 상담**: 실시간 채팅을 통한 상담 지원
- **모바일 앱**: React Native 또는 Flutter를 활용한 모바일 앱 개발

---

## 7. 프로젝트 구조 (참고)

```
smartfarm-consulting-agent/
├── app/                    # Next.js App Router
│   ├── (routes)/          # 라우트 그룹
│   │   ├── page.tsx       # 홈/인트로
│   │   ├── step1/         # STEP 1 페이지
│   │   ├── step2/         # STEP 2 페이지
│   │   ├── step3/         # STEP 3 페이지
│   │   ├── step4/         # STEP 4 페이지
│   │   ├── summary/       # 요약 확인 페이지
│   │   ├── result/        # 견적 결과 페이지
│   │   └── report/        # AI 리포트 페이지
│   ├── api/               # API Routes
│   │   ├── estimate/      # 견적 저장/조회
│   │   └── report/        # 리포트 생성
│   └── layout.tsx         # 루트 레이아웃
├── components/             # React 컴포넌트
│   ├── ui/                # 기본 UI 컴포넌트
│   ├── forms/             # 폼 관련 컴포넌트
│   └── layout/            # 레이아웃 컴포넌트
├── lib/                   # 유틸리티 및 비즈니스 로직
│   ├── schemas/           # Zod 스키마
│   ├── utils/             # 유틸리티 함수
│   ├── business/          # 비즈니스 로직 (견적 계산 등)
│   └── supabase/          # Supabase 클라이언트
├── types/                 # TypeScript 타입 정의
├── public/                # 정적 파일
├── docs/                  # 문서
│   └── 01-project-overview.md
└── supabase/              # Supabase 설정 (선택)
    └── migrations/        # DB 마이그레이션 파일
```

---

## 8. 주요 고려사항

### 8.1 성능
- **이미지 최적화**: Next.js Image 컴포넌트 활용
- **코드 스플리팅**: 동적 import를 통한 번들 크기 최적화
- **캐싱**: Vercel Edge Network 활용, Supabase 쿼리 캐싱

### 8.2 보안
- **환경 변수**: API 키 등 민감 정보는 환경 변수로 관리
- **입력 검증**: 클라이언트 및 서버 양쪽에서 검증
- **Rate Limiting**: API 엔드포인트에 요청 제한 적용 (향후)

### 8.3 접근성
- **WCAG 준수**: 키보드 네비게이션, 스크린 리더 지원
- **반응형 디자인**: 모바일, 태블릿, 데스크톱 지원

### 8.4 모니터링 및 로깅
- **에러 추적**: Vercel Analytics 또는 Sentry 활용
- **성능 모니터링**: Vercel Analytics 또는 별도 APM 도구

---

**문서 버전**: 1.0  
**최종 업데이트**: 2024년  
**작성자**: 개발팀

